summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/4 + c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/25 + c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/2 + c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
count <- c(1,2,3,4)
cumsum(count)[-length(count)]
c(0,cumsum(count)[-length(count)])
cumsum(count)
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/4 + c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/2 + c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/2 + c(0, cumsum(count)[length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/2 + c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/3 + c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count + c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/2 + c(0, cumsum(count)[-length(count)]),
label = percent(percent)))
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = count/2 + c(0, cumsum(count)[-length(count)]),
label = percent(percent)), size = 5)
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = -count/2 + cumsum(count),
label = percent(percent)), size = 5)
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
arrange(count) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = -count/2 + cumsum(count),
label = percent(percent)), size = 5)
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
arrange(count) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = -count/3 + cumsum(count),
label = percent(percent)), size = 5)
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
arrange(count) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(y = -count/2 + cumsum(count),
label = percent(percent)), size = 5)
masterpiece %>%
group_by(system) %>%
summarize(count = n(), percent = count/nrow(masterpiece)) %>%
arrange(count) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank()) +
geom_text(aes(x = 1, y = -count/2 + cumsum(count),
label = percent(percent)), size = 5)
masterpiece %>%
group_by(system) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Dark2") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank())
masterpiece %>%
group_by(system) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Paired") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank())
ls()
masterpiece %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = genre)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Paired") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank())
plot2 <- masterpiece %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = genre)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Spectral") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank())
grid.arrange(plot1, plot2)
plot1 <- masterpiece %>%
group_by(system) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Paired") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank())
grid.arrange(plot1, plot2)
grid.arrange(plot1, plot2, nrow = 1)
plot1 <- masterpiece %>%
group_by(system) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Paired") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "top")
plot2 <- masterpiece %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = genre)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Spectral") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "bottom")
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- masterpiece %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = genre)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Set3") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "bottom")
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- masterpiece %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = "deepskyblue4")) +
geom_col(position = "dodge") +
scale_fill_brewer(palette = "Set3") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "none")
grid.arrange(plot1, plot2, nrow = 1)
plot2 <- masterpiece %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = system, y = count, col = "deepskyblue4")) +
geom_col(position = "dodge") +
coord_flip() +
scale_fill_brewer(palette = "Set3") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "none")
grid.arrange(plot1, plot2, nrow = 1)
masterpiece %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = system, y = count, col = "deepskyblue4")) +
geom_col(position = "dodge") +
coord_flip() +
scale_fill_brewer(palette = "Set3") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "none")
masterpiece %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = system, y = count, col = "deepskyblue4")) +
geom_col(position = "dodge") +
coord_flip() +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "none")
masterpiece %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = genre, y = count, col = "deepskyblue4")) +
geom_col(position = "dodge") +
coord_flip() +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "none")
masterpiece %>%
mutate(genre = factor(genre,
levels = names(sort(table(genre), decreasing=TRUE)))) %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = genre, y = count, fill = "deepskyblue4")) +
geom_col(position = "dodge") +
coord_flip() +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "none")
masterpiece %>%
mutate(genre = factor(genre,
levels = names(sort(table(genre), decreasing=FALSE)))) %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = genre, y = count, fill = "deepskyblue4")) +
geom_col(position = "dodge") +
coord_flip() +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "none")
masterpiece %>%
mutate(genre = factor(genre,
levels = names(sort(table(genre), decreasing=FALSE)))) %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = genre, y = count, fill = "deepskyblue4")) +
geom_col(position = "dodge") +
coord_flip() +
theme_tufte() +
labs(y = "Count")
masterpiece %>%
mutate(genre = factor(genre,
levels = names(sort(table(genre), decreasing=FALSE)))) %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = genre, y = count)) +
geom_col(position = "dodge", fill = "deepskyblue4") +
coord_flip() +
theme_tufte() +
labs(y = "Count")
masterpiece %>%
mutate(genre = factor(genre,
levels = names(sort(table(genre), decreasing=FALSE)))) %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = genre, y = count)) +
geom_col(position = "dodge", fill = "deepskyblue4") +
coord_flip() +
theme_tufte() +
labs(y = "Count")
grid.arrange(plot1, plot2, nrow = 1)
grid.arrange(plot1, plot2)
plot1 <- masterpiece %>%
group_by(system) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Paired") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "top")
grid.arrange(plot1, plot2)
grid.arrange(plot1, plot2)
plot1
plot2
plot2 <- masterpiece %>%
mutate(genre = factor(genre,
levels = names(sort(table(genre), decreasing=FALSE)))) %>%
group_by(genre) %>%
summarize(count = n()) %>%
ggplot(aes(x = genre, y = count)) +
geom_col(fill = "deepskyblue4") +
coord_flip() +
theme_tufte() +
labs(y = "Count")
plot2
grid.arrange(plot1, plot2)
grid.arrange(plot1, plot2)
grid.arrange(plot1, plot2, nrow = 1)
plot1 <- masterpiece %>%
group_by(system) %>%
summarize(count = n()) %>%
ggplot(aes(x = "", y = count, fill = system)) +
geom_col(width = 1) +
coord_polar("y", start = 0) +
scale_fill_brewer(palette = "Accent") +
theme_tufte() +
theme(axis.title.x = element_blank(), axis.title.y = element_blank(),
legend.position = "top")
grid.arrange(plot1, plot2, nrow = 1)
library(wordcloud)
library(ngram)
title_masterpiece <- concatenate(masterpiece$title)
head(title_masterpiece)
library(qdap)
library(tm)
head(stopwords("en"))
clean <- function(x){
x <- replace_contraction(x)
x <- removePunctuation(x)
x <- tolower(x)
x <- removeWords(x, stopwords("en"))
}
uni_gram <- ngram(title_masterpiece, n = 1)
unigram <- clean(unigram)
uni_gram <- clean(uni_gram)
title_masterpiece <- clean(title_masterpiece)
uni_gram <- ngram(title_masterpiece, n = 1)
head(uni_gram)
print(uni_gram, "truncated")
?ngram
freq <- get.phrasetable(uni_gram)
head(freq)
dim(freq)
wordcloud(freq$ngrams, freq$freq)
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"))
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), scale = c(1,2))
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), scale = c(1,2), min.freq = 1)
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), scale = c(1,2), max.words = 50)
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), scale = c(1,2), max.words = 91)
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), max.words = 91)
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), min.words = 91)
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"))
title <- concatenate(ign$title)
clean2 <- function(x){
x <- removeNumbers(x)
}
title <- clean(title)
uni_gram <- ngram(title, n = 1)
freq <- get.phrasetable(uni_gram)
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), max.words = 200)
head(freq)
freq <- freq[-1:3,]
freq <- freq[-(1:3),]
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), max.words = 200)
head(freq)
title <- concatenate(ign$title)
clean2 <- function(x){
x <- removeNumbers(x)
}
title <- clean2(title)
head(title)
title <- clean(title)
uni_gram <- ngram(title, n = 1)
freq <- get.phrasetable(uni_gram)
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), max.words = 200)
wordcloud(freq$ngrams, freq$freq, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"), max.words = 200)
names(ign)
sum(grepl("[Ss]tar [Ww]world", x = ign$title))
sum(grepl("[Ss]tar [Ww]orld", x = ign$title))
sum(grepl(".[Ss]tar [Ww]orld.", x = ign$title))
sum(grepl(".[Ss]tar[Ww]orld.", x = ign$title))
sum(grepl("star.*"), ign$title)
sum(grepl("star.*", ign$title))
sum(grepl(".*[Ss]tar[Ww]orld.*", x = ign$title))
sum(grepl("[Ss]tar[Ww]orld.*", x = ign$title))
sum(grepl("Star[Ww]orld.*", x = ign$title))
sum(grepl("star[Ww]orld.*", x = ign$title))
sum(grepl("star [Ww]orld.*", x = ign$title))
sum(grepl("star world.*", x = ign$title))
sum(grepl(".*[Ss]tar [Ww]ar.*", x = ign$title))
index <- grepl(".*[Ss]tar [Ww]ar.*", x = ign$title)
print(paste("There are", sum(index), "Star War related titles"))
head(ign$title[index])
index <- grepl(".*[Ss]tar [Ww]ar.*", x = ign$title)
print(paste("There are", sum(index), "Star War related titles"))
head(ign$title[index], 20)
ign %>% filter(release_year == min(release_year)) %>% select(title)
table(ign$release_year)
which(ign$release_year == 1970)
ign$title[517,]$title
ign$title[517,]
ign$title[517]
names(ign)
